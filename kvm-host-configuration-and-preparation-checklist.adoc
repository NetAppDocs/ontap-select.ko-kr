---
sidebar: sidebar 
permalink: kvm-host-configuration-and-preparation-checklist.html 
keywords: ontap select, pre-installation checklist, kvm, host preparation 
summary: ONTAP Select 노드가 배포된 각 KVM 하이퍼바이저 호스트를 준비합니다. 호스트를 준비할 때는 배포 환경을 신중하게 평가하여 호스트가 올바르게 구성되고 ONTAP Select 클러스터 배포를 지원할 준비가 되었는지 확인합니다. 
---
= ONTAP Select 위한 KVM 호스트 구성 및 준비 체크리스트
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
ONTAP Select 노드가 배포된 각 KVM 하이퍼바이저 호스트를 준비합니다. 호스트를 준비할 때는 배포 환경을 신중하게 평가하여 호스트가 올바르게 구성되고 ONTAP Select 클러스터 배포를 지원할 준비가 되었는지 확인합니다.


NOTE: ONTAP Select Deploy 관리 유틸리티는 하이퍼바이저 호스트의 필수 네트워크 및 스토리지 구성을 수행하지 않습니다. ONTAP Select 클러스터를 배포하기 전에 각 호스트를 수동으로 준비해야 합니다.



== 1단계: KVM 하이퍼바이저 호스트 준비

ONTAP Select 노드가 배포된 각 Linux KVM 서버를 준비해야 합니다. 또한 ONTAP Select 배포 관리 유틸리티가 배포되는 서버를 준비해야 합니다.

.단계
. Red Hat Enterprise Linux(RHEL)을 설치합니다.
+
ISO 이미지를 사용하여 RHEL 운영 체제를 설치하세요. 지원되는 RHEL 버전의 목록은 를 link:reference_plan_ots_hardware.html#software-compatibility["하이퍼바이저에 대한 소프트웨어 호환성 정보"]참조하십시오. 설치 중에 다음과 같이 시스템을 구성하세요.

+
.. 보안 정책으로 기본값을 선택합니다.
.. 가상화 호스트 소프트웨어를 선택하세요.
.. 대상이 ONTAP Select 에서 사용하는 RAID LUN이 아닌 로컬 부팅 디스크인지 확인하세요.
.. 시스템을 부팅한 후 호스트 관리 인터페이스가 작동 중인지 확인하세요.
+

NOTE: /etc/sysconfig/network-scripts 아래에서 올바른 네트워크 구성 파일을 편집한 다음 를 사용하여 인터페이스를 불러올 수 있습니다 `ifup` 명령.



. ONTAP Select 에 필요한 추가 패키지를 설치합니다.
+
ONTAP Select에는 몇 가지 추가 소프트웨어 패키지가 필요합니다. 정확한 패키지 목록은 사용 중인 Linux 버전에 따라 다릅니다. 첫 번째 단계로 yum 리포지토리를 서버에서 사용할 수 있는지 확인합니다. 사용할 수 없는 경우 다음을 사용하여 검색할 수 있습니다.  `wget your_repository_location` 명령.

+

NOTE: Linux 서버 설치 중에 소프트웨어 선택을 위해 가상화된 호스트를 선택한 경우 필요한 패키지 중 일부가 이미 설치되어 있을 수 있습니다. 에 설명된 대로 소스 코드에서 openvswitch 패키지를 설치해야 할 수 있습니다 link:https://docs.openvswitch.org/en/latest/intro/install/general/["vSwitch 문서를 엽니다"^].

+
필요한 패키지 및 기타 구성 요구 사항에 대한 자세한 내용은 를 참조하십시오link:https://imt.netapp.com/matrix/#welcome["상호 운용성 매트릭스 툴"^].

. 스토리지 풀을 구성합니다.
+
ONTAP Select 스토리지 풀은 기본 물리적 스토리지를 추상화하는 논리적 데이터 컨테이너입니다. ONTAP Select가 구축된 KVM 호스트에서 스토리지 풀을 관리해야 합니다.





== 2단계: 스토리지 풀 만들기

각 ONTAP Select 노드에 최소한 하나의 스토리지 풀을 만듭니다. 로컬 하드웨어 RAID 대신 소프트웨어 RAID를 사용하는 경우, 스토리지 디스크가 루트 및 데이터 애그리게이트의 노드에 연결됩니다. 이 경우에도 시스템 데이터에 대한 스토리지 풀을 생성해야 합니다.

.시작하기 전에
ONTAP Select가 구축된 호스트에서 Linux CLI에 로그인할 수 있는지 확인합니다.

.이 작업에 대해
ONTAP Select Deploy 관리 유틸리티는 스토리지 풀의 타겟 위치를 로 지정해야 합니다 `/dev/<pool_name>`, 위치 `<pool_name>` 는 호스트의 고유한 풀 이름입니다.


NOTE: 스토리지 풀이 생성될 때 LUN의 전체 용량이 할당됩니다.

.단계
. Linux 호스트에서 로컬 디바이스를 표시하고 스토리지 풀을 포함할 LUN을 선택합니다.
+
[source, cli]
----
lsblk
----
+
적절한 LUN은 스토리지 용량이 가장 큰 디바이스일 가능성이 높습니다.

. 디바이스의 스토리지 풀을 정의합니다.
+
[source, cli]
----
virsh pool-define-as <pool_name> logical --source-dev <device_name> --target=/dev/<pool_name>
----
+
예를 들면 다음과 같습니다.

+
[listing]
----
virsh pool-define-as select_pool logical --source-dev /dev/sdb --target=/dev/select_pool
----
. 스토리지 풀 구축:
+
[source, cli]
----
virsh pool-build <pool_name>
----
. 스토리지 풀을 시작합니다.
+
[source, cli]
----
virsh pool-start <pool_name>
----
. 시스템 부팅 시 자동으로 시작되도록 스토리지 풀을 구성합니다.
+
[source, cli]
----
virsh pool-autostart <pool_name>
----
. 스토리지 풀이 생성되었는지 확인합니다.
+
[source, cli]
----
virsh pool-list
----




== 3단계: 선택적으로 스토리지 풀을 삭제합니다.

더 이상 필요하지 않은 스토리지 풀을 삭제할 수 있습니다.

.시작하기 전에
ONTAP Select가 배포된 Linux CLI에 로그인할 수 있는지 확인합니다.

.이 작업에 대해
ONTAP Select Deploy 관리 유틸리티는 스토리지 풀의 타겟 위치를 로 지정해야 합니다 `/dev/<pool_name>`, 위치 `<pool_name>` 는 호스트의 고유한 풀 이름입니다.

.단계
. 스토리지 풀이 정의되어 있는지 확인합니다.
+
[source, cli]
----
virsh pool-list
----
. 스토리지 풀 제거:
+
[source, cli]
----
virsh pool-destroy <pool_name>
----
. 비활성 스토리지 풀에 대한 구성 정의 해제:
+
[source, cli]
----
virsh pool-undefine <pool_nanme>
----
. 스토리지 풀이 호스트에서 제거되었는지 확인합니다.
+
[source, cli]
----
virsh pool-list
----
. 스토리지 풀 볼륨 그룹의 모든 논리적 볼륨이 삭제되었는지 확인합니다.
+
.. 논리 볼륨을 표시합니다.
+
[source, cli]
----
lvs
----
.. 풀에 대한 논리적 볼륨이 있는 경우 삭제합니다.
+
[source, cli]
----
lvremove <logical_volume_name>
----


. 볼륨 그룹이 삭제되었는지 확인합니다.
+
.. 볼륨 그룹을 표시합니다.
+
[source, cli]
----
vgs
----
.. 풀에 대한 볼륨 그룹이 있는 경우 삭제합니다.
+
[source, cli]
----
vgremove <volume_group_name>
----


. 물리적 볼륨이 삭제되었는지 확인합니다.
+
.. 물리적 볼륨을 표시합니다.
+
[source, cli]
----
pvs
----
.. 풀에 대한 물리적 볼륨이 있는 경우 삭제합니다.
+
[source, cli]
----
pvremove <physical_volume_name>
----






== 4단계: ONTAP Select 클러스터 구성 검토

ONTAP Select를 다중 노드 클러스터 또는 단일 노드 클러스터로 구축할 수 있습니다. 많은 경우, 추가 저장 용량과 고가용성(HA) 기능 때문에 다중 노드 클러스터가 더 선호됩니다.

다음 그림은 ESXi 호스트의 단일 노드 클러스터 및 4노드 클러스터에 사용되는 ONTAP Select 네트워크를 보여줍니다.

[role="tabbed-block"]
====
.단일 노드 클러스터
--
다음 그림에서는 단일 노드 클러스터를 보여 줍니다. 외부 네트워크에는 클라이언트, 관리 및 클러스터 간 복제 트래픽(SnapMirror/SnapVault)이 포함됩니다.

image:CHK_01.jpg["단일 노드 클러스터에 네트워크 1개 표시"]

--
.4노드 클러스터
--
다음 그림은 두 개의 네트워크를 보여주는 4노드 클러스터를 보여줍니다. 내부 네트워크는 ONTAP 클러스터 네트워크 서비스를 지원하는 노드 간의 통신을 가능하게 합니다. 외부 네트워크에는 클라이언트, 관리 및 클러스터 간 복제 트래픽(SnapMirror/SnapVault)이 포함됩니다.

image:CHK_02.jpg["2개의 네트워크를 보여 주는 4노드 클러스터"]

--
.4노드 클러스터 내의 단일 노드
--
다음 그림에서는 4노드 클러스터 내의 단일 ONTAP Select 가상 머신에 대한 일반적인 네트워크 구성을 보여 줍니다. ONTAP-내부 및 ONTAP-외부라는 2개의 별도 네트워크가 있습니다.

image:CHK_03.jpg["4노드 클러스터 내의 단일 노드"]

--
====


== 5단계: Open vSwitch 구성

Open vSwitch를 사용하여 각 KVM 호스트 노드에서 소프트웨어 정의 스위치를 구성합니다.

.시작하기 전에
네트워크 관리자가 비활성화되어 있고 기본 Linux 네트워크 서비스가 활성화되어 있는지 확인합니다.

.이 작업에 대해
ONTAP Select에는 2개의 개별 네트워크가 필요하며, 둘 다 포트 본딩을 활용하여 네트워크에 HA 기능을 제공합니다.

.단계
. Open vSwitch가 호스트에서 활성 상태인지 확인합니다.
+
.. Open vSwitch가 실행 중인지 확인합니다.
+
[source, cli]
----
systemctl status openvswitch
----
.. Open vSwitch가 실행되고 있지 않으면 다음을 시작합니다.
+
[source, cli]
----
systemctl start openvswitch
----


. Open vSwitch 구성을 표시합니다.
+
[source, cli]
----
ovs-vsctl show
----
+
Open vSwitch가 호스트에 아직 구성되지 않은 경우 구성은 비어 있는 상태로 표시됩니다.

. 새 vSwitch 인스턴스 추가:
+
[source, cli]
----
ovs-vsctl add-br <bridge_name>
----
+
예를 들면 다음과 같습니다.

+
[source, cli]
----
ovs-vsctl add-br ontap-br
----
. 네트워크 인터페이스를 중단합니다.
+
[source, cli]
----
ifdown <interface_1>
ifdown <interface_2>
----
. LACP(Link Aggregation Control Protocol)를 사용하여 링크를 결합합니다.
+
[source, cli]
----
ovs-vsctl add-bond <internal_network> bond-br <interface_1> <interface_2> bond_mode=balance-slb lacp=active other_config:lacp-time=fast
----
+

NOTE: 인터페이스가 두 개 이상인 경우에만 연결을 구성하면 됩니다.

. 네트워크 인터페이스 실행:
+
[source, cli]
----
ifup <interface_1>
ifup <interface_2>
----

